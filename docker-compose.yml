version: '2'
services:
    db:
        image: postgres
        volumes:
            - ./srv/pg-data:/var/lib/postgresql/data
        environment:
            - POSTGRES_USER=codeassign
            - POSTGRES_PASSWORD=codeassign
            - POSTGRES_DB=codeassign
        restart: always

    frontend-files:
        build: ./codeassign-frontend
        volumes:
            - frontend:/usr/src/app/dist

    frontend:
        image: kyma/docker-nginx
        volumes:
            - frontend:/var/www:ro
        restart: always

    backend:
        build: ./codeassign-backend
        links:
            - db
        ports:
            - 5000:80
        restart: always

volumes:
    frontend: {}
